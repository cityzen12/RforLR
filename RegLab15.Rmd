---
title: "二分类问题：Logit模型和Probit模型"
output: html_notebook
---

# 预备知识

* 复习本章讲义，掌握Logit模型和Probit模型的模型设定，估计和检验方法；
* 掌握分类模型的模型评估方法.

# 上机实验

## 实验一 上市公司ST风险预测

分析数据`ST.csv`，这是讲义上的例子，请重复讲义上的分析.

* 读取数据.
```{r}
ST=read.csv("../data/ST.csv",header=T)
head(ST)
```

* 样本里被ST警示和未被ST警示的公司各有多少家？

* 用`lm`函数拟合线性概率模型，分析变量的显著性；

* 用`glm`函数拟合线性概率模型，看结果是否一样？

* 分别拟合logit模型和Probit模型，比较参数估计和拟合值；

* 分别取阈值为0.5和0.0526来进行预测，计算混淆矩阵，根据混淆矩阵来分别计算真阳性率和假阳性率.



## 实验二 信贷风险评估

分析数据`loanapp`，这是教材第七章的课后计算机练习C8. 目标是在银行贷款审批中是否存在种族歧视，
感兴趣的被解释变量是`approve`，取值为1代表贷款被批准；主要的解释变量为`white`，等于1表示白人.
在建模中需要控制其它变量的影响，这些变量的实际含义查看帮助.

* 加载数据
```{r}
library("wooldridge")
data("loanapp")
head(loanapp)
?loanapp
```

* 由于数据中存在缺失值，我们先选取那些分析中要用到的变量构成新的数据集，然后再去掉那些含有缺失数据的样本.

```{r}
da = loanapp[,c("approve","white","hrat","obrat","loanprc","unem","male","married","dep","sch","cosign","chist","pubrec","mortlat1","mortlat2","vr")]
head(da)
da2 = na.omit(da)
dim(da2)
```

* 先考虑一个线性概率模型
$$approve = \beta_0+\beta_1white+u$$
如果存在种族歧视，那么$\beta1$的符号应如何？

* 估计上述模型，解释参数估计的意义，其显著性如何？实际上大吗？

* 在上述模型里，控制其它因素，变量`white`前的系数发了何种变化？仍有种族歧视的证据吗？

* 允许种族效应与债务占比(obrat)有交互效应，请问交互效应显著吗？

* 在$obrat=32$(平均值)时，估计白人对贷款获批概率的影响,构造一个95%的置信区间；

* 用logit和probit模型重新考察上述问题，结果如何？



## 实验三 电信公司客户流失分析

通过对某移动通信公司客户的流失数据进行分析，了解客户流失的影响因素，建立客户流失预警系统，为客户关系管理服务.

某年度随机抽取了1000个移动通信客户,数据文件为`TeleCom.csv`。被解释变量是他们来年的流失情形（1代表流失，0代表未流失）。解释变量来自当年的数据，包括

* 客户等级：1，2，3，4
* 主叫次数：7日内日均主叫次数/90日内日均主叫次数；
* 被叫次数：7日内日均被叫次数/90日内日均被叫次数；
* 通话时长：7日内日均通话时长/90日内日均通话时长；
* 费用：    7日内日均通话费用/90日内日均通话费用；

建立Logistic回归模型并进行分析和预测.
